---
kind: compose
metadata:
  name: Grafana Alloy
  description: |-
    Grafana Alloy is an open telemetry collector distribution that gathers
    and processes logs, metrics, traces and profiles. It combines features
    from the OpenTelemetry Collector and Prometheus and provides programmable
    pipelines and high-performance, vendor-neutral observability.
    ## Prerequisites
    - :info: Set the `container_hostname` to your desired hostname. (This is
    useful for identification in logs and metrics systems.)
    ## References
    * **Project:** https://grafana.com/docs/alloy/
    * **Source:** https://github.com/grafana/alloy
    * **Documentation:** https://grafana.com/docs/alloy/latest/
  version: v1.11.2
  author: Christian Lempa
  date: '2025-10-13'
  tags:
    - traefik
schema: "1.2"
spec:
  general:
    vars:
      general_webui_enabled:
        type: bool
        description: Enable Alloy web user interface
  ports:
    vars:
      ports_webui:
        type: int
        description: Main port for Alloy HTTP server
        default: 12345
        needs: ["general_webui_enabled=true"]
        required: true
  logs:
    name: Log Collection
    description: Configure log collection for Docker containers and system logs
    toggle: logs_enabled
    vars:
      logs_enabled:
        type: bool
        description: Enable log collection
        default: false
      logs_loki_url:
        type: url
        description: Loki endpoint URL for sending logs
        default: http://loki:3100/loki/api/v1/push
        required: true
      logs_docker:
        type: bool
        description: Enable Docker container log collection
      logs_system:
        type: bool
        description: Enable system and journalctl log collection
  metrics:
    name: Metrics Collection
    description: Configure metrics collection for Docker containers and system metrics
    toggle: metrics_enabled
    vars:
      metrics_enabled:
        type: bool
        description: Enable metrics collection
        default: false
      metrics_prometheus_url:
        type: url
        description: Prometheus remote write endpoint
        default: http://prometheus:9090/api/v1/write
        required: true
      metrics_docker:
        type: bool
        description: Enable Docker container metrics collection (cAdvisor)
      metrics_system:
        type: bool
        description: Enable system (node) metrics collection
