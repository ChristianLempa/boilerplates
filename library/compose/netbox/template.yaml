kind: compose
metadata:
    name: NetBox
    description: |-
        Network infrastructure management (IPAM/DCIM) and network automation source of truth. Provides comprehensive API for managing IP addresses, circuits, devices, racks, cables, and other network infrastructure components with powerful automation capabilities.
        ## References
        * **Project:** https://netbox.dev/
        * **Documentation:** https://docs.netbox.dev/
        * **GitHub:** https://github.com/netbox-community/netbox
    version: 4.2.3
    author: Christian Lempa
    date: "2025-11-13"
    tags:
        - traefik
    draft: false
schema: "1.2"
spec:
    database:
        key: database
        title: ""
        vars:
            database_name:
                default: netbox
            database_user:
                default: netbox
            redis_password:
                description: Redis password for authentication
                type: str
                sensitive: true
                autogenerated: true
                required: true
    email:
        key: email
        title: ""
        vars:
            email_from:
                default: netbox@example.com
            email_server:
                type: str
                default: localhost
    general:
        key: general
        title: ""
        vars:
            service_name:
                default: netbox
    netbox:
        key: netbox
        title: NetBox Configuration
        description: Configure NetBox application settings
        vars:
            netbox_metrics_enabled:
                description: Enable Prometheus metrics endpoint
                type: bool
                default: false
            netbox_secret_key:
                description: Secret Key
                type: str
                sensitive: true
                autogenerated: true
                required: true
                extra: Used for cryptographic signing and session management
    ports:
        key: ports
        title: ""
        vars:
            ports_http:
                description: Host port for HTTP
                default: 8000
    swarm:
        key: swarm
        title: ""
        description: |
            Docker Swarm deployment requires an external PostgreSQL database. Enable 'database_external' in the Database section first.
        needs:
            - database_external=true
        vars:
            swarm_placement_host:
                description: Target hostname for stateful services (NetBox, Redis)
            swarm_worker_placement_host:
                description: Target hostname for worker service (replicated mode only)
                type: str
                needs: [swarm_worker_placement_mode=replicated]
            swarm_worker_placement_mode:
                description: Deployment mode for worker service
                type: enum
                default: replicated
                options: [replicated, global]
                required: true
            swarm_worker_replicas:
                description: Number of worker replicas for queue processing
                type: int
                default: 1
                required: true
                needs: [swarm_worker_placement_mode=replicated]
    traefik:
        key: traefik
        title: ""
        vars:
            traefik_host:
                default: netbox
