---
- name: Manage Checkmk host
  hosts: localhost
  gather_facts: false
  tasks:
    - name: "Create or update host in Checkmk"
      checkmk.general.host:
        server_url: "{{ checkmk_protocol }}://{{ checkmk_server }}"
        site: {{ checkmk_site }}
        automation_user: {{ checkmk_user }}
        automation_secret: {{ checkmk_pass }}
        name: {{ host_name }}
        attributes:
          ipaddress: {{ host_ip }}
        folder: {{ host_folder }}
        state: "present"
